# Описание
## Подготовка данных:
* минимальная аугментация - зеркальное отражение (делать вертикальный переворот и делать поворот на случайных угол показались не очень хорошими идеями);
* было решено изменить размер изображений на 128x128, т.к. увеличение размера не приводило к значительному увеличению качества;
* вместо исплользования стандартных цифр для ImageNet, средние и среднеквадратические отклонения для нормализации были посчитаны на всей выборке;
* данные были разбиты на обучающую (44992 фотографий мужчин и 44992 фотографий женщин) и валидационную (по 5009 изображений) путем выбора случайных изображений из каждого класса;

## Используемая нейросеть
В рамках задачи было решено сопоставить относительно маленькие модели: ResNet34 и EfficientNet-B3. С использованием последней ожидаемо был достигнут лучший результат (также файл с обученными весами весит в два раза меньше).

## Гиперпараметры:
* размер батча и шаг обучения - 32 и 0.008 соответсвенно;
* максимальное количество эпох - 10 (наилучший результат на валидации был получен на 9 эпохе)

## Результаты
* высокие значения метрика: ROC-AUC и accuracy на валидации - 0.998 и примерно 0.98 соответственно;
* относительно компактная модель (файл с весами - 41 МБ);
* модель путает женщин и мужчин в равной степени: FP - 770, FN - 691 (посчитано на всех данных)

# Применение модели
Если данные, к которым необходимо применить модель, находятся в папке data, а результаты необходимо поместить в папку results, то можно использовать команду с параметрами по умолчанию:

```
python apply.py
```

Иначе необходимо изменить параметр(ы):
* -data_path [путь к данным]
* -result_path [путь к папке, куда хотим сохранить результаты]
* -device [cpu или gpu]
* -model_path [путь к словарю с весами модели]
* -cls_thr [порог для определения класса объекта]
